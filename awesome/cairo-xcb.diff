Index: Makefile
===================================================================
RCS file: /cvsroot/pkgsrc/graphics/cairo/Makefile,v
retrieving revision 1.76
diff -u -r1.76 Makefile
--- Makefile	26 Aug 2009 19:57:36 -0000	1.76
+++ Makefile	19 Dec 2009 14:44:18 -0000
@@ -20,7 +20,6 @@
 USE_TOOLS+=		pkg-config
 PKGCONFIG_OVERRIDE+=	src/cairo.pc.in src/cairo-features.pc.in
 GNU_CONFIGURE=		yes
-CONFIGURE_ARGS+=	--disable-xcb
 CONFIGURE_ARGS+=	--enable-glitz
 CONFIGURE_ARGS+=	--enable-pdf
 CONFIGURE_ARGS+=	--enable-ps
Index: PLIST
===================================================================
RCS file: /cvsroot/pkgsrc/graphics/cairo/PLIST,v
retrieving revision 1.25
diff -u -r1.25 PLIST
--- PLIST	14 Jun 2009 17:59:07 -0000	1.25
+++ PLIST	19 Dec 2009 14:44:18 -0000
@@ -9,6 +9,8 @@
 ${PLIST.carbon}include/cairo/cairo-quartz-image.h
 include/cairo/cairo-svg.h
 include/cairo/cairo-version.h
+${PLIST.xcb}include/cairo/cairo-xcb-xrender.h
+${PLIST.xcb}include/cairo/cairo-xcb.h
 ${PLIST.x11}include/cairo/cairo-xlib-xrender.h
 ${PLIST.x11}include/cairo/cairo-xlib.h
 include/cairo/cairo.h
@@ -22,6 +24,7 @@
 ${PLIST.carbon}lib/pkgconfig/cairo-quartz-image.pc
 ${PLIST.carbon}lib/pkgconfig/cairo-quartz.pc
 lib/pkgconfig/cairo-svg.pc
+${PLIST.xcb}lib/pkgconfig/cairo-xcb.pc
 ${PLIST.x11}lib/pkgconfig/cairo-xlib-xrender.pc
 ${PLIST.x11}lib/pkgconfig/cairo-xlib.pc
 lib/pkgconfig/cairo.pc
Index: buildlink3.mk
===================================================================
RCS file: /cvsroot/pkgsrc/graphics/cairo/buildlink3.mk,v
retrieving revision 1.31
diff -u -r1.31 buildlink3.mk
--- buildlink3.mk	20 Mar 2009 19:24:37 -0000	1.31
+++ buildlink3.mk	19 Dec 2009 14:44:18 -0000
@@ -20,6 +20,7 @@
 
 .if !empty(PKG_BUILD_OPTIONS.cairo:Mx11)
 .include "../../x11/libXrender/buildlink3.mk"
+.include "../../x11/xcb-util/buildlink3.mk"
 .endif
 
 .include "../../fonts/fontconfig/buildlink3.mk"
Index: options.mk
===================================================================
RCS file: /cvsroot/pkgsrc/graphics/cairo/options.mk,v
retrieving revision 1.4
diff -u -r1.4 options.mk
--- options.mk	12 Apr 2008 22:43:01 -0000	1.4
+++ options.mk	19 Dec 2009 14:44:18 -0000
@@ -1,12 +1,12 @@
 # $NetBSD: cairo-xcb.diff,v 1.1.1.1 2009/12/19 15:21:40 pallegra Exp $
 
 PKG_OPTIONS_VAR=	PKG_OPTIONS.cairo
-PKG_SUPPORTED_OPTIONS=	x11
-PKG_SUGGESTED_OPTIONS=	x11
+PKG_SUPPORTED_OPTIONS=	x11 xcb
+PKG_SUGGESTED_OPTIONS=	x11 xcb
 
 .include "../../mk/bsd.options.mk"
 
-PLIST_VARS+=		x11
+PLIST_VARS+=		x11 xcb
 
 ###
 ### X11 support
@@ -21,6 +21,18 @@
 .include "../../x11/libX11/buildlink3.mk"
 BUILDLINK_DEPMETHOD.libXt?=	build # only for configure
 .include "../../x11/libXt/buildlink3.mk"
+.include "../../x11/xcb-util/buildlink3.mk"
 .else
 CONFIGURE_ARGS+=	--disable-xlib --disable-xlib-xrender
 .endif
+
+###
+### xcb support
+###
+.if !empty(PKG_OPTIONS:Mx11)
+CONFIGURE_ARGS+=	--enable-xcb
+PLIST.xcb=		yes
+.include "../../x11/xcb-util/buildlink3.mk"
+.else
+CONFIGURE_ARGS+=	--disable-xcb
+.endif
