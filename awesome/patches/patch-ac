$NetBSD: patch-ac,v 1.2 2009/12/20 23:49:47 pallegra Exp $

--- CMakeLists.txt.orig	2009-11-26 19:03:25.000000000 +0000
+++ CMakeLists.txt
@@ -177,6 +177,7 @@ if(GENERATE_MANPAGES)
                        ${BUILD_DIR} xmlfile ${xmlfile})
         string(REGEX REPLACE ".xml\$" ".gz" gzfile ${xmlfile})
         string(REGEX REPLACE ".gz\$" "" manfile ${gzfile})
+        string(REGEX REPLACE ".xml\$" "" manfile ${xmlfile})
 
         add_custom_command(
             COMMAND ${ASCIIDOC_EXECUTABLE} -d manpage -b docbook -o ${xmlfile} - < ${txtfile}
@@ -189,18 +190,27 @@ if(GENERATE_MANPAGES)
             OUTPUT  ${manfile}
             WORKING_DIRECTORY ${BUILD_DIR}/manpages
             DEPENDS ${xmlfile})
-        add_custom_command(
-            COMMAND ${GZIP_EXECUTABLE} < ${manfile} > ${gzfile}
-            OUTPUT  ${gzfile}
-            WORKING_DIRECTORY ${BUILD_DIR}/manpages
-            DEPENDS ${manfile}
-            VERBATIM)
 
-        set(MAN_FILES ${MAN_FILES} ${gzfile})
+        if(COMPRESS_MANPAGES)
+            add_custom_command(
+                COMMAND ${GZIP_EXECUTABLE} < ${manfile} > ${gzfile}
+                OUTPUT  ${gzfile}
+                WORKING_DIRECTORY ${BUILD_DIR}/manpages
+                DEPENDS ${manfile}
+                VERBATIM)
+
+            set(MAN_FILES ${MAN_FILES} ${gzfile})
+        else()
+            set(MAN_FILES ${MAN_FILES} ${manfile})
+        endif()
 
         # figure out in what section to install to from filename
         string(REGEX REPLACE "^.*\\.([0-9])\\.gz\$" "\\1" section ${gzfile})
-        set(AWE_MAN${section}_FILES ${AWE_MAN${section}_FILES} ${gzfile})
+        if(COMPRESS_MANPAGES)
+            set(AWE_MAN${section}_FILES ${AWE_MAN${section}_FILES} ${gzfile})
+        else()
+            set(AWE_MAN${section}_FILES ${AWE_MAN${section}_FILES} ${manfile})
+        endif()
     endforeach()
 
     add_custom_target(man ALL DEPENDS ${MAN_FILES})
@@ -291,15 +301,17 @@ endif()
 install(TARGETS ${PROJECT_AWE_NAME} RUNTIME DESTINATION bin)
 install(FILES "utils/awsetbg" DESTINATION bin PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
 install(FILES "utils/awesome-client" DESTINATION bin PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ WORLD_EXECUTE)
-install(DIRECTORY ${BUILD_DIR}/lib DESTINATION ${AWESOME_DATA_PATH})
-install(FILES ${AWE_CONF_FILE_DEFAULT} DESTINATION ${AWESOME_SYSCONFDIR}
+install(DIRECTORY ${BUILD_DIR}/lib DESTINATION ${AWESOME_DATA_PATH}
+    PATTERN "*.in" EXCLUDE)
+install(FILES ${AWE_CONF_FILE_DEFAULT} DESTINATION ${AWESOME_EGDIR}
         RENAME ${AWE_CONF_FILE})
 if(GENERATE_MANPAGES)
     install(FILES ${AWE_MAN1_FILES} DESTINATION ${AWESOME_MAN_PATH}/man1)
     install(FILES ${AWE_MAN5_FILES} DESTINATION ${AWESOME_MAN_PATH}/man5)
 endif()
 install(DIRECTORY ${AWE_ICON_DIR} DESTINATION ${AWESOME_DATA_PATH})
-install(DIRECTORY ${BUILD_DIR}/themes DESTINATION ${AWESOME_DATA_PATH})
+install(DIRECTORY ${BUILD_DIR}/themes DESTINATION ${AWESOME_DATA_PATH}
+    PATTERN "*.in" EXCLUDE)
 install(DIRECTORY ${SOURCE_DIR}/themes DESTINATION ${AWESOME_DATA_PATH}
     PATTERN "*.in" EXCLUDE)
 install(FILES ${AWE_DOC_FILES} DESTINATION ${AWESOME_DOC_PATH})
