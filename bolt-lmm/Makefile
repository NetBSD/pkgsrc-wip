# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Wed Sep 20 05:34:25 CDT 2017               #
###########################################################

PKGNAME=	bolt-lmm-2.3.2
DISTNAME=	BOLT-LMM_v${PKGVERSION_NOREV}
PKGREVISION=	1
CATEGORIES=	biology
MASTER_SITES=	https://data.broadinstitute.org/alkesgroup/BOLT-LMM/downloads/ \
		https://data.broadinstitute.org/alkesgroup/BOLT-LMM/downloads/old/

MAINTAINER=	bacon@NetBSD.org
HOMEPAGE=	https://data.broadinstitute.org/alkesgroup/BOLT-LMM/
COMMENT=	Statistics for testing association between phenotype and genotypes
LICENSE=	gnu-gpl-v3

USE_LANGUAGES=	c c++ fortran
USE_TOOLS+=	gmake pax

MAKE_FILE=	${FILESDIR}/Makefile
MAKE_ENV+=	LAPACK_LIBS="${LAPACK_LIBS}"
CXXFLAGS+=	-fopenmp

DATADIR=	share/bolt-lmm
EXAMPLESDIR=	share/examples/bolt-lmm

INSTALLATION_DIRS=	bin ${DATADIR} ${EXAMPLESDIR}

SUBST_CLASSES+=		data
SUBST_STAGE.data=	pre-configure
SUBST_FILES.data=	src/BoltParams.cpp
SUBST_SED.data=		-e 's|tables/|${PREFIX}/${DATADIR}/tables|g'

SUBST_CLASSES+=		example
SUBST_STAGE.example=	pre-configure
SUBST_FILES.example=	example/run_example.sh
SUBST_SED.example=	-e 's|../tables/|${PREFIX}/${DATADIR}/tables/|g'

post-patch:
	${RM} ${WRKSRC}/example/*.orig ${WRKSRC}/bolt

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/src/bolt ${DESTDIR}${PREFIX}/bin
	cd ${WRKSRC} && pax -rw tables ${DESTDIR}${PREFIX}/${DATADIR}
	cd ${WRKSRC}/example && pax -rw * ${DESTDIR}${PREFIX}/${EXAMPLESDIR}
	${CHMOD} a+x ${DESTDIR}${PREFIX}/${EXAMPLESDIR}/*.sh
	${CHMOD} g-w ${DESTDIR}${PREFIX}/${EXAMPLESDIR}/*

.include "../../mk/blas.buildlink3.mk"
.include "../../math/nlopt/buildlink3.mk"
.include "../../devel/boost-libs/buildlink3.mk"
.include "../../devel/zlib/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
