# $NetBSD: Makefile,v 1.1 2014/09/04 21:51:02 outpaddling Exp $

###########################################################
#               Generated by fbsd2pkg                     #
###########################################################
# This version is known for frequent crashes
# FIXME: boost problem and hackaround:
# https://svn.boost.org/trac/boost/query?status=!closed&page=3&order=summary&row=description: #9331

DISTNAME=	cufflinks-2.2.1
CATEGORIES=	biology
MASTER_SITES=	http://cole-trapnell-lab.github.io/cufflinks/assets/downloads/

MAINTAINER=	bacon@NetBSD.org

COMMENT=	RNA transcript assembly, differential expression/regulation
LICENSE=	boost-license

USE_LANGUAGES=		c c++
GNU_CONFIGURE=		yes
CONFIGURE_ARGS+=	--with-bam=${PREFIX}/samtools0119

# Darwin
CFLAGS+=	-I${PREFIX}/include/eigen3
# These are getting left out on CentOS and Darwin in spite of buildlink
LDFLAGS+=	-L${PREFIX}/lib -lboost_thread -lboost_system -lboost_serialization

# Darwin i386 Snow Leopard doesn't support /bin/arch or /usr/bin/arch -k
SUBST_CLASSES+=		arch
SUBST_STAGE.arch=	post-patch
SUBST_FILES.arch=	configure
SUBST_SED.arch=		-e 's|arch -k|arch|g'

# Allow compiling on i386
SUBST_CLASSES+=		cflags
SUBST_STAGE.cflags=	post-patch
SUBST_FILES.cflags=	configure
SUBST_SED.cflags=	-e 's|-arch x86_64||g'

SUBST_CLASSES+=		ldouble
SUBST_STAGE.ldouble=	post-patch
SUBST_FILES.ldouble=	${WRKSRC}/src/*.cpp ${WRKSRC}/src/*.h
SUBST_SED.ldouble=	-e 's|logl|log|g'
SUBST_SED.ldouble+=	-e 's|long double|double|g'

.include "../../wip/samtools0119/buildlink3.mk"
.include "../../devel/boost-libs/buildlink3.mk"
.include "../../devel/boost-headers/buildlink3.mk"
.include "../../devel/boost-jam/buildlink3.mk"
# CentOS can't find libbam without this.  samtools buildlink issue?
.include "../../devel/zlib/buildlink3.mk"
.include "../../math/eigen3/buildlink3.mk"
.include "../../lang/python/application.mk"
.include "../../mk/bsd.pkg.mk"
