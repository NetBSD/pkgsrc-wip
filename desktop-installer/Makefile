# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Sun Jun 11 07:07:13 CDT 2023               #
###########################################################

DISTNAME=	desktop-installer-0.8.0.15
CATEGORIES=	sysutils
MASTER_SITES=	${MASTER_SITE_GITHUB:=outpaddling/}
GITHUB_TAG=	6553007e5836fbe9f81fba3100b353f9f89071e9

OWNER=		bacon@NetBSD.org
HOMEPAGE=	https://acadix.biz/desktop-installer.php
COMMENT=	Quickly configure a \${OPSYS} desktop system
LICENSE=	2-clause-bsd

# Script is NetBSD-specific in many ways
ONLY_FOR_PLATFORM=	NetBSD-*-*

SUBST_CLASSES+=	tk
SUBST_STAGE.tk=	pre-configure
SUBST_SED.tk=	-e 's|/usr/pkg/bin/wish|${PREFIX}/bin/wish|g'
SUBST_FILES.tk=	NetBSD/XDM/xdmshutdown

USE_TOOLS+=	pax
NO_BUILD=	yes

.include "../../mk/bsd.prefs.mk"

DATADIR=		${PREFIX}/share/${PKGBASE}
INSTALLATION_DIRS=	sbin ${PKGMANDIR}/man1 share/${PKGBASE}

do-install:
	${INSTALL_SCRIPT} ${WRKSRC}/${OPSYS}/${PKGBASE} ${DESTDIR}${PREFIX}/sbin
	${INSTALL_SCRIPT} ${WRKSRC}/Scripts/battery-shutdown.sh ${DESTDIR}${PREFIX}/sbin
	${INSTALL_MAN} ${WRKSRC}/Doc/${PKGBASE}.man \
		${DESTDIR}${PREFIX}/${PKGMANDIR}/man1/${PKGBASE}.1
	${MKDIR} ${DESTDIR}${DATADIR}
	cd ${WRKSRC}/Common && pax -rw . ${DESTDIR}${DATADIR}
	cd ${WRKSRC}/NetBSD && pax -rw XDM ${DESTDIR}${DATADIR}

# Binary package is behind pkgsrc, and tcl build fails
# Run pkgin install tk so that XDM buttons will work
# .include "../../x11/tk/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
