# $NetBSD: Makefile.common,v 1.19 2021/11/27 05:37:59 pho Exp $
#
# used by wip/gkrellm-share/Makefile
# used by wip/gkrellm-server/Makefile

GKRELLM_VERSION=	2.4.0
GKRELLM_DISTBASE=	gkrellm-${GKRELLM_VERSION}

DISTNAME=	${GKRELLM_DISTBASE}
PKGNAME=	${GKRELLM_PKGBASE}-${GKRELLM_VERSION}
CATEGORIES=	sysutils
MASTER_SITES=	https://gkrellm.srcbox.net/releases/
EXTRACT_SUFX=	.tar.bz2

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	https://gkrellm.srcbox.net/
LICENSE=	gnu-gpl-v3

USE_TOOLS+=		gmake

FILESDIR=		${.CURDIR}/../../wip/gkrellm/files
PATCHDIR=		${.CURDIR}/../../wip/gkrellm/patches
DISTINFO_FILE=		${.CURDIR}/../../wip/gkrellm/distinfo

.include "../../wip/gkrellm/options.mk"
.include "../../mk/bsd.fast.prefs.mk"

BROKEN_EXCEPT_ON_PLATFORM=	# empty

###
### Darwin
###
BROKEN_EXCEPT_ON_PLATFORM+=	Darwin-*-*
.if ${OPSYS} == "Darwin"
.  if !empty(PKG_OPTIONS:Mquartz)
GKRELLM_PER_PLATFORM_TARGET=	macosx
.  elif ${OPSYS_VERSION} >= 100400 # post-Tiger; libkvm unavailable
GKRELLM_PER_PLATFORM_TARGET=	darwin9
.  else
GKRELLM_PER_PLATFORM_TARGET=	darwin
.  endif
.endif

###
### DragonFly
###
BROKEN_EXCEPT_ON_PLATFORM+=	DragonFly-*-*
.if ${OPSYS} == "DragonFly"
GKRELLM_PER_PLATFORM_TARGET=	dragonfly
.endif

###
### FreeBSD
###
BROKEN_EXCEPT_ON_PLATFORM+=	FreeBSD-*-*
.if ${OPSYS} == "FreeBSD"
.  if ${OPSYS_VERSION} >= 030000
GKRELLM_PER_PLATFORM_TARGET=	freebsd
.  else
GKRELLM_PER_PLATFORM_TARGET=	freebsd2
.  endif
.endif

###
### Linux
###
BROKEN_EXCEPT_ON_PLATFORM+=	Linux-*-*
.if ${OPSYS} == "Linux"
GKRELLM_PER_PLATFORM_TARGET=	all
.endif

###
### NetBSD
###
BROKEN_EXCEPT_ON_PLATFORM+=	NetBSD-*-*
.if ${OPSYS} == "NetBSD"
.  if ${OPSYS_VERSION} >= 020000
GKRELLM_PER_PLATFORM_TARGET=	netbsd2
.  else
GKRELLM_PER_PLATFORM_TARGET=	netbsd1
.  endif
.endif

###
### OpenBSD
###
BROKEN_EXCEPT_ON_PLATFORM+=	OpenBSD-*-*
.if ${OPSYS} == "OpenBSD"
GKRELLM_PER_PLATFORM_TARGET=	openbsd
.endif

###
### SunOS
###
BROKEN_EXCEPT_ON_PLATFORM+=	SunOS-*-*
.if ${OPSYS} == "SunOS"
GKRELLM_PER_PLATFORM_TARGET=	solaris
.endif
