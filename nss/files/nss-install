#!/bin/sh
#
# $NetBSD: nss-install,v 1.2 2005/01/24 09:53:51 matthewluckie Exp $
#
# this script takes care of installing the nspr package, and is based on
# the moz-install script found in pkgsrc/www/mozilla/
#

# generate the PLIST that will be installed
# use a trap to ensure that the TMP_PLIST is removed if something goes wrong
#
TMP_PLIST=${WRKDIR}/TMP_PLIST.$$
trap "${RM} -f ${TMP_PLIST}" 1 2 15
${SED} -e "s/\${SO_SUFFIX}/${SO_SUFFIX}/" < ${PLIST_SRC} > ${TMP_PLIST}

# make directories to install the includes
${BSD_INSTALL_DATA_DIR} ${PREFIX}/include/nss
for dir in dbm nss seccmd ; do
	${BSD_INSTALL_DATA_DIR} ${PREFIX}/include/nss/$dir
done

# install the includes
for i in `${EGREP} ^include/nss ${TMP_PLIST}` ; do
	src=`echo $i | ${SED} -e "s@include/nss@public@`;
	${BSD_INSTALL_DATA} ${DIST}/$src ${PREFIX}/$i
done

# install the libraries
for i in `${EGREP} ^lib/ ${TMP_PLIST}` ; do
	src=`echo $i | ${SED} -e "s@lib@${OPSYS}${OS_VERSION}_OPT\.OBJ/lib@"`;
	${NSS_INSTALL_LIB} ${DIST}/${src} ${PREFIX}/$i
done

# install the binaries
for i in `${EGREP} ^bin/ ${TMP_PLIST}` ; do
	src=`echo $i | ${SED} -e "s@bin@${OPSYS}${OS_VERSION}_OPT\.OBJ/bin@"`;
	${BSD_INSTALL_PROGRAM} ${DIST}/${src} ${PREFIX}/$i
done
