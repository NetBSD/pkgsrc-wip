# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Mon Sep 12 17:24:02 CDT 2016               #
###########################################################

DISTNAME=	pbbam-${PORTVERSION}
CATEGORIES=	biology
MASTER_SITES=	${MASTER_SITE_GITHUB:=PacificBiosciences/}
GITHUB_PROJECT=	pbbam
GITHUB_TAG=	e46654e0e0b816230c16f4a6132c1feff633a62a

MAINTAINER=	bacon@NetBSD.org
HOMEPAGE=	https://github.com/PacificBiosciences/pbbam
COMMENT=	PacBio BAM C++ library, with SWIG bindings
LICENSE=	modified-bsd

MAKE_JOBS_SAFE=	yes

USE_LANGUAGES=	c c++
USE_TOOLS+=	pax
USE_CMAKE=	yes
# FIXME: Disable tests for now.  Bound to bundled googletest.
CMAKE_ARGS=	-DHTSLIB_INCLUDE_DIRS:STRING=${PREFIX}/include/htslib \
		-DHTSLIB_LIBRARIES:STRING="-L${PREFIX}/lib" \
		-DPacBioBAM_build_tests:BOOL=OFF \
		-DPacBioBAM_build_docs:BOOL=OFF
GCC_REQD=	4.9	# pbcopper requires 4.9 due to use of json

CXXFLAGS+=	-O2

WRKSRC=		${WRKDIR}/pbbam-${GITHUB_TAG}

PORTVERSION=	2016.09.13

INSTALLATION_DIRS=	bin lib ${PKGMANDIR}/man1 share/doc share/examples

MAKE_FLAGS+=	VERBOSE=1
# FIXME: Shouldn't buildlink provide this?
LDFLAGS+=	-L${PREFIX}/lib -lhts -lssl

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/bin/* ${DESTDIR}${PREFIX}/bin
	${INSTALL_DATA} ${WRKSRC}/lib/* ${DESTDIR}${PREFIX}/lib
	cd ${WRKSRC}/include && pax -rw * ${DESTDIR}${PREFIX}/include

.include "../../devel/boost-libs/buildlink3.mk"
.include "../../wip/htslib/buildlink3.mk"
.include "../../security/openssl/buildlink3.mk"
.include "../../devel/zlib/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
