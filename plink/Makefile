# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Mon Aug 28 18:05:44 CDT 2017               #
###########################################################

DISTNAME=	plink-1.9b6.17
CATEGORIES=	biology
MASTER_SITES=	${MASTER_SITE_GITHUB:=chrchang/}
GITHUB_PROJECT=	plink-ng
GITHUB_TAG=	79b2df8cffce480148b7d2197e4981bfeff3a3c0

MAINTAINER=	pkgsrc-users@NetBSD.org
HOMEPAGE=	https://www.cog-genomics.org/plink/
COMMENT=	Whole genome association analysis toolset
LICENSE=	gnu-gpl-v2

BUILDLINK_API_DEPENDS.zlib+=	zlib>=1.2.4

# We need Fortran LDFLAGS to link with Lapack.
USE_LANGUAGES=	c c++ fortran
USE_TOOLS+=	gmake

WRKSRC=		${WRKDIR}/plink-ng-${GITHUB_TAG}/1.9

CFLAGS+=	-DDYNAMIC_ZLIB -I${PREFIX}/include -I. ${BLAS_INCLUDES}
CXXFLAGS+=	-DDYNAMIC_ZLIB -I${PREFIX}/include ${BLAS_INCLUDES}
MAKE_FLAGS+=	ZLIB=-lz BLASFLAGS="-L${PREFIX}/lib ${LAPACK_LIBS} ${CBLAS_LIBS}  -lpthread"
INSTALL_TARGET=	install-strip

BLAS_ACCEPTED=	openblas_pthread

BLAS_C_INTERFACE=	yes

INSTALLATION_DIRS=	bin

post-patch:
	${CP} ${WRKSRC}/Makefile.std ${WRKSRC}/Makefile

do-install:
	${INSTALL_PROGRAM} ${WRKSRC}/plink ${DESTDIR}${PREFIX}/bin

.include "../../mk/blas.buildlink3.mk"
.include "../../devel/zlib/buildlink3.mk"
.include "../../devel/simde/buildlink3.mk"
.include "../../mk/pthread.buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
