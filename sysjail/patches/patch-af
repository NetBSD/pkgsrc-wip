$NetBSD: patch-af,v 1.1.1.1 2006/06/01 12:03:23 lkundrak Exp $

--- src/intercept-ioctl.c.orig	2006-05-05 22:34:54.000000000 +0200
+++ src/intercept-ioctl.c
@@ -31,15 +31,21 @@
 #include <sys/ioctl.h>
 #include <sys/socket.h>
 #include <sys/syscall.h>
+#ifdef __NetBSD__
+#include <systrace.h>
+#else
 #include <dev/systrace.h>
+#endif
 #include <sys/lkm.h>
 
+#include <netinet/in.h>
 #include <net/if.h>
 #include <net/pfvar.h>
 #include <net/route.h>
-#include <netinet/in.h>
 #include <netinet/if_ether.h>
+#ifndef __NetBSD__
 #include <net/if_bridge.h>
+#endif
 
 #include <assert.h>
 #include <stdio.h>
@@ -82,7 +88,9 @@ inter_ioctl(int fd, struct str_message *
 		} \
 	} while (0)
 	/* /usr/include/sys/lkm.h */
+#ifndef __NetBSD__
 	CHECK_IOCTL(LMRESERV_O);
+#endif
 	CHECK_IOCTL(LMLOADBUF);
 	CHECK_IOCTL(LMUNRESRV);
 	CHECK_IOCTL(LMREADY);
@@ -103,7 +111,9 @@ inter_ioctl(int fd, struct str_message *
 	CHECK_IOCTL(SIOCSIFMETRIC);
 	CHECK_IOCTL(SIOCDIFADDR);
 	CHECK_IOCTL(SIOCAIFADDR);
+#ifndef __NetBSD__
 	CHECK_IOCTL(SIOCSIFLLADDR);
+#endif
 	CHECK_IOCTL(SIOCALIFADDR);
 	CHECK_IOCTL(SIOCDLIFADDR);
 	CHECK_IOCTL(SIOCADDMULTI);
@@ -113,6 +123,7 @@ inter_ioctl(int fd, struct str_message *
 	CHECK_IOCTL(SIOCSIFPHYADDR);
 	CHECK_IOCTL(SIOCDIFPHYADDR);
 	CHECK_IOCTL(SIOCSLIFPHYADDR);
+#ifndef __NetBSD__
 	CHECK_IOCTL(SIOCBRDGADD);
 	CHECK_IOCTL(SIOCBRDGDEL);
 	CHECK_IOCTL(SIOCBRDGSIFFLGS);
@@ -132,6 +143,7 @@ inter_ioctl(int fd, struct str_message *
 	CHECK_IOCTL(SIOCBRDGSMA);
 	CHECK_IOCTL(SIOCBRDGSIFPRIO);
 	CHECK_IOCTL(SIOCBRDGSIFCOST);
+#endif
 	/*SIOCBRDGS ?? */
 	/*GRESADDRS ?? */
 	/*GRESADDRD ?? */
@@ -140,14 +152,18 @@ inter_ioctl(int fd, struct str_message *
 	/*GRESPROTO ?? */
 	/*GREGPROTO ?? */
 	CHECK_IOCTL(SIOCSIFMTU);
+#ifndef __NetBSD__
 	CHECK_IOCTL(SIOCSIFASYNCMAP);
+#endif
 	CHECK_IOCTL(SIOCIFCREATE);
 	CHECK_IOCTL(SIOCIFDESTROY);
+#ifndef __NetBSD__
 	CHECK_IOCTL(SIOCAIFGROUP);
 	CHECK_IOCTL(SIOCDIFGROUP);
 	CHECK_IOCTL(SIOCSIFDESCR);
 	CHECK_IOCTL(SIOCSIFTIMESLOT);
 	CHECK_IOCTL(SIOCSVH);
+#endif
 	/* SIOCSETPFSYNC ?? */
 	/* /usr/include/net/pfvar.h */
 	CHECK_IOCTL(DIOCSTART);
