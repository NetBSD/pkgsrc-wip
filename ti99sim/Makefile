# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Mon Oct  7 11:59:41 CDT 2024               #
###########################################################

DISTNAME=	${PKGNAME}.src
PKGNAME=	ti99sim-${PV}
CATEGORIES=	emulators
MASTER_SITES=	https://www.mrousseau.org/programs/ti99sim/archives/
EXTRACT_SUFX=	.tar.xz

OWNER=		bacon@NetBSD.org
HOMEPAGE=	https://www.mrousseau.org/programs/ti99sim/
COMMENT=	SDL-based TI-99/4a simulator
LICENSE=	gnu-gpl-v3

# Test and change if necessary.
# MAKE_JOBS_SAFE=	no

# Just assuming C and C++: Adjust this!
USE_LANGUAGES=	c c++
USE_TOOLS+=	gmake

WRKSRC=		${WRKDIR}/ti99sim-${PV}
# FIXME: Is it necessary for binaries to exist in DATADIR, or can
# BIN_DIR be ${PREFIX}/bin?
MAKE_FLAGS+=	DATA_DIR=${DESTDIR}${DATADIR} \
		BIN_DIR=${DESTDIR}${DATADIR}/bin \
		SYS_BIN=${DESTDIR}${PREFIX}/bin \
		MAKE=${PREFIX}/bin/gmake
# FIXME: This shouldn't be needed
LDFLAGS+=	-L${PREFIX}/lib ${COMPILER_RPATH_FLAG}${PREFIX}/lib -lcrypto

PV=		0.16.0
DATADIR=	${PREFIX}/share/ti99sim

post-patch:
	${SED} -e 's|/usr/local|${PREFIX}|g' ${FILESDIR}/ti99sim-setup > ${WRKDIR}/ti99sim-setup

post-install:
	${INSTALL_SCRIPT} ${WRKDIR}/ti99sim-setup ${DESTDIR}${PREFIX}/bin

.include "../../security/openssl/buildlink3.mk"
.include "../../devel/SDL2/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
