# $NetBSD$
#
###########################################################
#                  Generated by fbsd2pkg                  #
#              Mon Oct  7 11:59:41 CDT 2024               #
###########################################################

DISTNAME=	ti99sim-0.16.0.17
CATEGORIES=	emulators
MASTER_SITES=	${MASTER_SITE_GITHUB:=outpaddling/}
GITHUB_TAG=	5c027150ecdc41a6f444e208d14efe569ecf098e

OWNER=		bacon@NetBSD.org
HOMEPAGE=	https://www.mrousseau.org/programs/ti99sim/
COMMENT=	SDL-based TI-99/4a simulator
LICENSE=	gnu-gpl-v3

SUBST_CLASSES+=		prefix
SUBST_STAGE.prefix=	pre-configure
SUBST_SED.prefix=	-e 's|/usr/local|${PREFIX}|g'
SUBST_FILES.prefix=	scripts/ti99sim-setup

# Fails on 8-core Mac Mini
MAKE_JOBS_SAFE=	no

# Just assuming C and C++: Adjust this!
USE_LANGUAGES=	c c++
USE_TOOLS+=	gmake

# FIXME: Is it necessary for binaries to exist in DATADIR, or can
# BIN_DIR be ${PREFIX}/bin?
MAKE_FLAGS+=	DATA_DIR=${DESTDIR}${DATADIR} \
		BIN_DIR=${DESTDIR}${PREFIX}/bin \
		SYS_BIN=${DESTDIR}${PREFIX}/bin \
		MAKE=${PREFIX}/bin/gmake
# FIXME: This shouldn't be needed
LDFLAGS+=	-L${PREFIX}/lib ${COMPILER_RPATH_FLAG}${PREFIX}/lib -lcrypto

DATADIR=	${PREFIX}/share/ti99sim

post-install:
	${INSTALL_SCRIPT} ${WRKSRC}/scripts/ti99sim-setup ${DESTDIR}${PREFIX}/bin

.include "../../security/openssl/buildlink3.mk"
.include "../../devel/SDL2/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"
